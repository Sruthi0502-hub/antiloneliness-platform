<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pallanguli ‚Äì Sentimate</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fdf3e0 0%, #f5e9d0 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        nav.navbar {
            background: #7a5c38;
            padding: 14px 28px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);
        }

        .navbar-brand {
            color: white;
            font-size: 1.4em;
            font-weight: 700;
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.85);
            text-decoration: none;
            margin-left: 20px;
            font-weight: 500;
        }

        .nav-link:hover {
            color: white;
        }

        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px 20px;
        }

        h1 {
            font-size: 2.4em;
            color: #5c3d1e;
            font-weight: 700;
            margin: 20px 0 6px;
        }

        .subtitle {
            color: #9a7a5a;
            font-size: 1em;
            margin-bottom: 24px;
        }

        /* ‚îÄ‚îÄ Status bar ‚îÄ‚îÄ */
        .status-bar {
            display: flex;
            gap: 40px;
            background: #fffbf4;
            border-radius: 14px;
            padding: 16px 36px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 28px;
            font-size: 1.1em;
            color: #5c3d1e;
            font-weight: 600;
        }

        .status-item span {
            color: #c0824a;
            font-size: 1.3em;
        }

        /* ‚îÄ‚îÄ Board ‚îÄ‚îÄ */
        .board-wrapper {
            background: #a0622a;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            margin-bottom: 28px;
        }

        .board-label {
            text-align: center;
            color: rgba(255, 255, 255, 0.75);
            font-size: 0.85em;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .board-row {
            display: flex;
            gap: 12px;
            margin-bottom: 14px;
        }

        .pit {
            width: 70px;
            height: 70px;
            background: #fdf3e0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            cursor: pointer;
            border: 3px solid #c09060;
            transition: all 0.2s;
            position: relative;
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .pit:hover:not(.empty) {
            background: #ffe0b0;
            transform: scale(1.08);
        }

        .pit:active:not(.empty) {
            transform: scale(0.95);
        }

        .pit.empty {
            cursor: default;
            opacity: 0.6;
        }

        .pit.selected {
            background: #ffe082;
            border-color: #f0a030;
            box-shadow: 0 0 0 4px rgba(240, 160, 40, 0.4);
        }

        .pit .seed-count {
            font-size: 1.4em;
            font-weight: 700;
            color: #5c3d1e;
        }

        .pit .seed-icon {
            font-size: 0.7em;
            color: #9a7a5a;
        }

        .store-row {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .store {
            width: 100px;
            height: 80px;
            background: #c8a060;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            border: 3px solid #a07840;
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.15);
        }

        .store .store-label {
            font-size: 0.7em;
            color: #fffbf4;
            font-weight: 600;
            text-transform: uppercase;
        }

        .store .store-count {
            font-size: 2em;
            font-weight: 700;
            color: white;
        }

        /* ‚îÄ‚îÄ Turn indicator ‚îÄ‚îÄ */
        .turn-indicator {
            font-size: 1.2em;
            color: #5c3d1e;
            font-weight: 600;
            background: #fff3dc;
            padding: 10px 28px;
            border-radius: 30px;
            margin-bottom: 16px;
            border: 2px solid #deb080;
        }

        /* ‚îÄ‚îÄ Controls ‚îÄ‚îÄ */
        .controls {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
        }

        .btn {
            border: none;
            border-radius: 12px;
            padding: 14px 32px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-reset {
            background: #c0824a;
            color: white;
        }

        .btn-reset:hover {
            background: #a0622a;
            transform: scale(1.03);
        }

        /* ‚îÄ‚îÄ Rules ‚îÄ‚îÄ */
        .rules-card {
            background: #fffbf4;
            border-radius: 16px;
            padding: 24px 32px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            max-width: 600px;
            width: 100%;
        }

        .rules-card h3 {
            color: #5c3d1e;
            margin-bottom: 12px;
            font-size: 1.2em;
        }

        .rules-card ul {
            color: #7a5c38;
            line-height: 2;
            padding-left: 20px;
        }

        /* ‚îÄ‚îÄ Message overlay ‚îÄ‚îÄ */
        .message {
            display: none;
            background: #ffe082;
            border: 2px solid #f0a030;
            border-radius: 12px;
            padding: 12px 28px;
            font-size: 1.1em;
            color: #5c3d1e;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .message.show {
            display: block;
        }

        @media (max-width: 600px) {
            .pit {
                width: 52px;
                height: 52px;
            }

            .pit .seed-count {
                font-size: 1.1em;
            }

            .board-row {
                gap: 8px;
            }

            .board-wrapper {
                padding: 14px;
            }
        }
    </style>
</head>

<body>

    <nav class="navbar">
        <div class="navbar-brand">Sentimate</div>
        <div>
            <a href="/traditional_games" class="nav-link">‚Üê Traditional Games</a>
            <a href="/games" class="nav-link">All Games</a>
        </div>
    </nav>

    <div class="container">
        <h1>ü™® Pallanguli</h1>
        <p class="subtitle">Classic South Indian mancala ‚Äì sow & capture the seeds!</p>

        <div class="status-bar">
            <div class="status-item">You: <span id="score-p1">0</span></div>
            <div class="status-item">Computer: <span id="score-p2">0</span></div>
            <div class="status-item">Round: <span id="round">1</span></div>
        </div>

        <div class="turn-indicator" id="turn-text">üü¢ Your turn ‚Äì click a pit to sow seeds</div>
        <div class="message" id="msg-box"></div>

        <div class="board-wrapper">
            <!-- Computer's row (top, reversed) -->
            <div class="board-label">Computer's Pits</div>
            <div class="board-row" id="row-p2"></div>

            <!-- Stores row -->
            <div class="store-row">
                <div class="store" id="store-p2">
                    <div class="store-label">Computer</div>
                    <div class="store-count" id="store-p2-count">0</div>
                </div>
                <div class="store" id="store-p1">
                    <div class="store-label">You</div>
                    <div class="store-count" id="store-p1-count">0</div>
                </div>
            </div>

            <!-- Player's row (bottom) -->
            <div class="board-label" style="margin-top:14px;">Your Pits</div>
            <div class="board-row" id="row-p1"></div>
        </div>

        <div class="controls">
            <button class="btn btn-reset" onclick="resetGame()">üîÑ New Game</button>
        </div>

        <div class="rules-card">
            <h3>üìú How to Play</h3>
            <ul>
                <li>The board has 2 rows of 7 pits, each starting with 6 seeds.</li>
                <li>Click one of <strong>your pits</strong> (bottom row) to pick up its seeds.</li>
                <li>Seeds are sown anti-clockwise, one per pit.</li>
                <li>If last seed lands in a pit with seeds ‚Üí continue sowing from that pit.</li>
                <li>If last seed lands in an <strong>empty pit</strong>, your turn ends.</li>
                <li>If the pit opposite the empty pit has seeds, you <strong>capture</strong> them!</li>
                <li>Player with the most seeds at the end wins.</li>
            </ul>
        </div>
    </div>

    <script>
        // ‚îÄ‚îÄ Game state ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const PITS = 7;
        const SEEDS_PER_PIT = 6;
        let board, stores, currentPlayer, gameOver, round;

        function initState() {
            board = [
                Array(PITS).fill(SEEDS_PER_PIT), // row 0 = player 1 (bottom)
                Array(PITS).fill(SEEDS_PER_PIT)  // row 1 = player 2 (top)
            ];
            stores = [0, 0];
            currentPlayer = 0; // 0=player1, 1=computer
            gameOver = false;
            round = 1;
        }

        // ‚îÄ‚îÄ Render ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function render() {
            renderRow('row-p1', 0, true);
            renderRow('row-p2', 1, false);
            document.getElementById('store-p1-count').textContent = stores[0];
            document.getElementById('store-p2-count').textContent = stores[1];
            document.getElementById('score-p1').textContent = stores[0];
            document.getElementById('score-p2').textContent = stores[1];
            document.getElementById('round').textContent = round;
            document.getElementById('turn-text').textContent =
                gameOver ? 'üèÅ Game Over!' :
                    (currentPlayer === 0 ? 'üü¢ Your turn ‚Äì click a pit to sow seeds' : 'ü§ñ Computer thinking‚Ä¶');
        }

        function renderRow(rowId, player, clickable) {
            const el = document.getElementById(rowId);
            el.innerHTML = '';
            const pits = player === 1 ? [...board[1]].reverse() : board[0];
            const actualIndices = player === 1 ? [...Array(PITS).keys()].map(i => PITS - 1 - i) : [...Array(PITS).keys()];

            pits.forEach((seeds, idx) => {
                const pit = document.createElement('div');
                pit.className = 'pit' + (seeds === 0 ? ' empty' : '');
                pit.innerHTML = `<span class="seed-count">${seeds}</span><span class="seed-icon">seeds</span>`;
                if (clickable && !gameOver && currentPlayer === 0 && seeds > 0) {
                    pit.addEventListener('click', () => playerMove(actualIndices[idx]));
                }
                el.appendChild(pit);
            });
        }

        // ‚îÄ‚îÄ Sow logic ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function sow(player, pitIndex) {
            let seeds = board[player][pitIndex];
            board[player][pitIndex] = 0;

            let row = player;
            let pos = pitIndex;
            let lastRow, lastPos;

            while (seeds > 0) {
                // Move to next pit
                if (row === 0) { pos++; }
                else { pos--; }

                // Switch rows at ends
                if (row === 0 && pos >= PITS) { row = 1; pos = 0; }
                else if (row === 1 && pos < 0) { row = 0; pos = PITS - 1; }

                board[row][pos]++;
                seeds--;
                lastRow = row;
                lastPos = pos;
            }
            return { lastRow, lastPos };
        }

        function doMove(player, pitIndex) {
            let { lastRow, lastPos } = sow(player, pitIndex);

            // Continue if landing pit had seeds before sowing (now >1)
            while (board[lastRow][lastPos] > 1) {
                const takeFrom = board[lastRow][lastPos];
                let res = sow(lastRow, lastPos);
                lastRow = res.lastRow;
                lastPos = res.lastPos;
            }

            // Capture: landing in empty pit (now ==1) ‚Üí take opposite
            if (board[lastRow][lastPos] === 1) {
                const oppRow = 1 - lastRow;
                const oppPos = PITS - 1 - lastPos;
                if (board[oppRow][oppPos] > 0) {
                    stores[player] += board[lastRow][lastPos] + board[oppRow][oppPos];
                    board[lastRow][lastPos] = 0;
                    board[oppRow][oppPos] = 0;
                    showMsg(player === 0 ? 'üéâ Capture! You grabbed seeds from the opponent!' : 'ü§ñ Computer captured!');
                }
            }

            checkGameOver();
        }

        // ‚îÄ‚îÄ Player move ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function playerMove(pitIndex) {
            if (gameOver || currentPlayer !== 0) return;
            if (board[0][pitIndex] === 0) return;
            clearMsg();
            doMove(0, pitIndex);
            if (!gameOver) {
                currentPlayer = 1;
                render();
                setTimeout(computerMove, 800);
            } else {
                render();
            }
        }

        // ‚îÄ‚îÄ Computer move (greedy) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function computerMove() {
            if (gameOver) return;
            const available = board[1].map((s, i) => s > 0 ? i : -1).filter(i => i >= 0);
            if (available.length === 0) { checkGameOver(); render(); return; }

            // Pick pit with most seeds
            const best = available.reduce((a, b) => board[1][a] >= board[1][b] ? a : b);
            doMove(1, best);
            currentPlayer = 0;
            render();
        }

        // ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function checkGameOver() {
            const p1Empty = board[0].every(s => s === 0);
            const p2Empty = board[1].every(s => s === 0);
            if (p1Empty || p2Empty) {
                // Sweep remaining seeds
                board[0].forEach((s, i) => { stores[0] += s; board[0][i] = 0; });
                board[1].forEach((s, i) => { stores[1] += s; board[1][i] = 0; });
                gameOver = true;
                if (stores[0] > stores[1]) showMsg('üèÜ You win! Well done!');
                else if (stores[1] > stores[0]) showMsg('ü§ñ Computer wins this round. Try again!');
                else showMsg("ü§ù It's a draw!");
            }
        }

        function showMsg(text) {
            const el = document.getElementById('msg-box');
            el.textContent = text;
            el.classList.add('show');
        }
        function clearMsg() {
            document.getElementById('msg-box').classList.remove('show');
        }

        function resetGame() {
            if (!gameOver) round++;
            initState();
            clearMsg();
            render();
        }

        // ‚îÄ‚îÄ Boot ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        initState();
        render();
    </script>
</body>

</html>